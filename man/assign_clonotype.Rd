% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clonotype_engine.R
\name{assign_clonotype}
\alias{assign_clonotype}
\title{Assign clonotypes from raw VDJ contig data}
\usage{
assign_clonotype(
  VDJ_data,
  sample_col = NULL,
  clone_definition_df = .clone.definition.df,
  is_cell = FALSE,
  high_confidence = FALSE,
  productive = FALSE,
  full_length = FALSE,
  remove_invalid_VDJ = FALSE,
  cdr3_col = "cdr3_nt",
  num_cores = 1,
  clone_loose = "single_chain_single_allele",
  verbose = TRUE
)
}
\arguments{
\item{VDJ_data}{A data frame of VDJ contig annotations in 10x Genomics
format.}

\item{sample_col}{Name of the column in \code{VDJ_data} to use as sample
identifier. If \code{NULL}, all cells are assigned to "Sample".}

\item{clone_definition_df}{Clone definition data frame specifying the
stringency hierarchy. Defaults to the built-in definition.}

\item{is_cell}{Logical. If \code{TRUE}, filter to rows where
\code{is_cell == "true"}.}

\item{high_confidence}{Logical. If \code{TRUE}, filter to rows where
\code{high_confidence == "true"}.}

\item{productive}{Logical. If \code{TRUE}, filter to rows where
\code{productive == "true"}.}

\item{full_length}{Logical. If \code{TRUE}, filter to rows where
\code{full_length == "true"}.}

\item{remove_invalid_VDJ}{Logical. If \code{TRUE}, set invalid VDJ
sequences to \code{NA}.}

\item{cdr3_col}{Which CDR3 column to use for building the composite TCR
chain identifier. Either \code{"cdr3_nt"} (nucleotide, default) or
\code{"cdr3"} (amino acid).}

\item{num_cores}{Number of cores for parallel processing. Set to \code{-1}
to use all available cores. Capped at the number of available cores and
the number of unique samples.}

\item{clone_loose}{Which stringency level to use as the default "loose"
clone definition.}

\item{verbose}{Logical. If \code{TRUE}, print progress messages.}
}
\value{
A list with two elements:
\describe{
\item{TCR_data}{Wide-format data frame with TCR chains, clone IDs at
each stringency level, and a default CloneID column.}
\item{ref_tables}{Named list of reference tables for each stringency
level.}
}
}
\description{
Complete VDJigsaw pipeline that takes raw VDJ contig annotations, pivots
them to wide format, validates TCR chains, identifies clonotypes at multiple
stringency levels, and returns the annotated data with clone assignments.
}
\examples{
\dontrun{
VDJ_contigs <- read.csv("filtered_contig_annotations.csv")
result <- assign_clonotype(VDJ_contigs, sample_col = "origin")
TCR_data <- result$TCR_data
ref_tables <- result$ref_tables
}

}
