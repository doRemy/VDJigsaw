% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clonotype_engine.R
\name{identify_clonotypes}
\alias{identify_clonotypes}
\title{Identify clonotypes at multiple stringency levels}
\usage{
identify_clonotypes(
  TCR_data,
  clone_definition_df = .clone.definition.df,
  num_cores = 1,
  sample_col = NULL,
  clone_loose = "single_chain_single_allele",
  verbose = TRUE
)
}
\arguments{
\item{TCR_data}{A data frame with columns TRA_1, TRA_2, TRB_1, TRB_2
containing validated TCR chain identifiers.}

\item{clone_definition_df}{Clone definition data frame specifying the
stringency hierarchy. Defaults to the built-in definition.}

\item{num_cores}{Number of cores for parallel processing across samples.
Set to \code{-1} to use all available cores. The actual number of cores
used is capped at the number of available cores and the number of unique
samples.}

\item{sample_col}{Name of the column to use as sample identifier. If
\code{NULL}, all cells are treated as one sample.}

\item{clone_loose}{Which stringency level to use as the "loose" default.
One of: "dual_chain_dual_allele", "dual_chain_one_partial",
"dual_chain_both_partial", "single_chain_dual_allele",
"single_chain_single_allele".}

\item{verbose}{Logical. If \code{TRUE}, print progress messages.}
}
\value{
A list with two elements:
\describe{
\item{TCR_data}{Data frame with clone ID columns for each stringency
level (CloneID.dual_chain_dual_allele, etc.) plus CloneID.loose.}
\item{ref_tables}{Named list of reference tables for each stringency
level, each containing CloneID, Sample, and unique TCR chain info.}
}
}
\description{
Groups cells into clonotypes using a hierarchy of stringency levels, from
strict (all four chains must match) to permissive (a single allele suffices).
Uses graph-based clustering via igraph to find connected components of
matching cells. Supports parallel processing across samples.
}
