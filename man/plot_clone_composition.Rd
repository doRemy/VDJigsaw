% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization_functions.R
\name{plot_clone_composition}
\alias{plot_clone_composition}
\title{Plot clonotype chain composition}
\usage{
plot_clone_composition(
  ref_table,
  top_n = 20,
  sample_filter = NULL,
  per_sample = FALSE,
  combined = TRUE,
  title = "Clonotype Chain Composition"
)
}
\arguments{
\item{ref_table}{A reference table from
\code{\link{identify_clonotypes}} or \code{\link{assign_clonotype}}
output (e.g., \code{result$ref_tables$dual_chain_both_partial}).
Must contain columns: TRA_1, TRB_1.}

\item{top_n}{Maximum number of clones to display. Clones are ranked by
chain richness (number of non-NA chains). Remaining clones are excluded.}

\item{sample_filter}{Optional sample name to filter to. If \code{NULL},
all samples are included. Ignored when \code{per_sample = TRUE}.}

\item{per_sample}{Logical. If \code{TRUE}, create a separate plot for
each unique sample in the reference table.}

\item{combined}{Logical. If \code{TRUE} and \code{per_sample = TRUE},
combine all per-sample plots into a single figure using
\code{patchwork}. If \code{FALSE}, return a named list of plots.}

\item{title}{Plot title.}
}
\value{
A \code{ggplot} object, or a named list of \code{ggplot} objects
when \code{per_sample = TRUE} and \code{combined = FALSE}.
}
\description{
Creates a tile chart showing the V gene usage for each chain position
(TRA_1, TRA_2, TRB_1, TRB_2) across clonotypes at a given stringency
level. Each tile is colored by V gene identity, making it easy to see
which clones share V gene segments and which chains are present or absent.
}
