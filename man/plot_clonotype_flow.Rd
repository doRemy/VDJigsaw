% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization_functions.R
\name{plot_clonotype_flow}
\alias{plot_clonotype_flow}
\title{Plot clonotype flow across stringency levels}
\usage{
plot_clonotype_flow(
  TCR_data,
  mapping_levels = .mapping.levels,
  top_n = 20,
  sample_filter = NULL,
  per_sample = FALSE,
  combined = TRUE,
  show_unassigned = FALSE,
  title = "Clonotype Flow Across Stringency Levels"
)
}
\arguments{
\item{TCR_data}{A data frame with clone ID columns for each stringency
level (as output by \code{\link{assign_clonotype}}).}

\item{mapping_levels}{Character vector of stringency level names in order
from most to least strict.}

\item{top_n}{Maximum number of clones to show at the loosest level. All
upstream clones feeding into these are kept; the rest are grouped as
"Other".}

\item{sample_filter}{Optional sample name to filter to. If \code{NULL},
all samples are included. Ignored when \code{per_sample = TRUE}.}

\item{per_sample}{Logical. If \code{TRUE}, create a separate plot for
each unique sample.}

\item{combined}{Logical. If \code{TRUE} and \code{per_sample = TRUE},
combine all per-sample plots into a single figure using
\code{patchwork}. If \code{FALSE}, return a named list of plots.}

\item{show_unassigned}{Logical. If \code{TRUE}, show "Unassigned" strata
for cells with \code{NA} clone IDs at stricter levels.}

\item{title}{Plot title.}
}
\value{
A \code{ggplot} object, or a named list of \code{ggplot} objects
when \code{per_sample = TRUE} and \code{combined = FALSE}.
}
\description{
Creates an alluvial diagram showing how clonotypes merge as stringency
is relaxed. Each vertical axis represents a stringency level, strata
represent clonotypes, and flows show cells moving between clone
definitions. Top-N filtering keeps the diagram readable.
}
\details{
Requires the \code{ggalluvial} package.
}
