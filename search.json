[{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with VDJigsaw","text":"vignette walks typical VDJigsaw workflow using real-world VDJ data 10x Genomics. end, assigned clonotypes multiple stringency levels visualized results. VDJigsaw ? Single-cell TCR sequencing often suffers dropout: cell’s second alpha beta chain allele may simply get captured. tools treat missing chains “different”, fragmenting clonotypes. VDJigsaw instead looks across whole dataset puzzle together cells likely belong clone, even chain data missing. five levels stringency, strict (four chains must match) permissive (single allele suffices).","code":""},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting started","title":"Getting Started with VDJigsaw","text":"","code":"library(VDJigsaw) library(dplyr) library(ggplot2) library(patchwork)"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"load-data","dir":"Articles","previous_headings":"","what":"Load data","title":"Getting Started with VDJigsaw","text":"illustrate VDJigsaw, use VDJ filtered contig data two publicly available 10x Genomics datasets: 10k Human Diseased PBMCs () — Freshly Processed (dataset | VDJ-TCR contigs) 10k Human Diseased PBMCs () — Fixed Stored (dataset | VDJ-TCR contigs) CSV files bundled package inst/extdata/. simplicity, tag dataset sample label combine : Let’s take quick look raw data — row one contig (one chain one cell):","code":"VDJ.contigs.fresh <- read.csv(system.file(   \"extdata\",   \"10k_5p_Human_diseased_PBMC_ALL_Fresh_vdj_t_filtered_contig_annotations.csv\",   package = \"VDJigsaw\"))  VDJ.contigs.fix <- read.csv(system.file(   \"extdata\",   \"10k_5p_Human_diseased_PBMC_ALL_Fix_stored_vdj_t_filtered_contig_annotations.csv\",   package = \"VDJigsaw\")) VDJ.contigs.fresh$orig.ident <- \"Fresh\" VDJ.contigs.fix$orig.ident   <- \"Fix\" VDJ.contigs <- rbind(VDJ.contigs.fresh, VDJ.contigs.fix) cat(nrow(VDJ.contigs), \"contigs across\", length(unique(VDJ.contigs$barcode)), \"unique barcodes\\n\") ## 27129 contigs across 13634 unique barcodes knitr::kable(head(VDJ.contigs[, c(\"barcode\", \"chain\", \"v_gene\", \"cdr3\", \"j_gene\", \"umis\", \"orig.ident\")], 5))"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"run-the-pipeline","dir":"Articles","previous_headings":"","what":"Run the pipeline","title":"Getting Started with VDJigsaw","text":"main function assign_clonotype() runs full VDJigsaw pipeline four steps: Pivot long-format contigs wide format (one row per cell, TRA_1, TRA_2, TRB_1, TRB_2 columns) Validate TCR chains (fix ordering, remove duplicates, flag invalid sequences) Identify clonotypes five stringency levels using graph-based clustering Return annotated data reference tables can set sample_col tell VDJigsaw sample structure. clone_loose parameter controls stringency level becomes default CloneID. Set num_cores speed processing multiple samples (use -1 available cores). Tip: Ideally, run VDJigsaw quality control scRNA-seq data remove low-quality barcodes doublets, skew clonotype assignments. result list two elements: TCR_data — wide-format data frame (one row per cell) TCR chains clone IDs every stringency level ref_tables — named list reference tables mapping CloneID chain composition","code":"VDJigsaw_res <- assign_clonotype(   VDJ_data = VDJ.contigs,   sample_col = \"orig.ident\",   clone_loose = \"single_chain_single_allele\",   num_cores = 1,   verbose = TRUE) ## [VDJigsaw] ======================================== ## [VDJigsaw] Starting VDJigsaw clonotype assignment ## [VDJigsaw] ======================================== ## [VDJigsaw] Detected raw contig input — pivoting to wide format ## [VDJigsaw] Converting VDJ data to wide format... ## [VDJigsaw]   Using cdr3_nt for CDR3 chain identifier ## [VDJigsaw]   Pivoting to wide format... ## [VDJigsaw]   Wide format: 13639 unique barcodes ## [VDJigsaw]   Creating TRA/TRB chain columns... ## [VDJigsaw] Wide format conversion complete: 98 columns ## [VDJigsaw] Validating and correcting TCR data... ## [VDJigsaw] Removed 1 duplicate alleles (allele 1 == allele 2) ## [VDJigsaw] Swapped 8 alleles where allele_2 was defined but allele_1 was not ## [VDJigsaw] TCR data correction complete ## [VDJigsaw] Identifying clonotypes and building reference tables... ## [VDJigsaw] Checking inputs... ## [VDJigsaw] Processing 13639 cells across 2 sample(s) ## [VDJigsaw] Using 1 core(s) for parallel processing ## [VDJigsaw] Combining results from parallel processing... ## [VDJigsaw]   dual_chain_dual_allele: 7432 clonotypes identified ## [VDJigsaw]   dual_chain_one_partial: 7139 clonotypes identified ## [VDJigsaw]   dual_chain_both_partial: 7117 clonotypes identified ## [VDJigsaw]   single_chain_dual_allele: 7116 clonotypes identified ## [VDJigsaw]   single_chain_single_allele: 7116 clonotypes identified ## [VDJigsaw] Clonotype identification complete! ## [VDJigsaw] ======================================== ## [VDJigsaw] Pipeline complete! ## [VDJigsaw] Assigned 13639 of 13639 cells (100%) to clonotypes ## [VDJigsaw] ========================================"},{"path":[]},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"tcr-data","dir":"Articles","previous_headings":"Explore the outputs","what":"TCR data","title":"Getting Started with VDJigsaw","text":"TCR_data table one row per cell barcode, clone IDs every stringency level: clone ID columns — cell gets assignment every stringency level:","code":"TCR_data <- VDJigsaw_res$TCR_data cat(nrow(TCR_data), \"cells,\", ncol(TCR_data), \"columns\\n\") ## 13639 cells, 109 columns clone_cols <- colnames(TCR_data)[grepl(\"^CloneID\\\\.\", colnames(TCR_data))] knitr::kable(head(TCR_data[, c(\"Sample\", \"barcode\", clone_cols)], 6))"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"reference-tables","dir":"Articles","previous_headings":"Explore the outputs","what":"Reference tables","title":"Getting Started with VDJigsaw","text":"ref_tables list contains one reference table per stringency level. table maps CloneID TCR chain composition. reference table columns CloneID, Sample, TCR chains. Let’s define small helper display compactly (showing V gene part chain save space):","code":"VDJigsaw_ref_tables <- VDJigsaw_res$ref_tables names(VDJigsaw_ref_tables) ## [1] \"dual_chain_dual_allele\"     \"dual_chain_one_partial\"     ## [3] \"dual_chain_both_partial\"    \"single_chain_dual_allele\"   ## [5] \"single_chain_single_allele\" \"loose\" # Helper: show ref table with truncated chain names for readability show_ref <- function(ref_tbl, n = 5) {   display_cols <- intersect(c(\"CloneID\", \"Sample\", \"TRA_1\", \"TRA_2\", \"TRB_1\", \"TRB_2\"), colnames(ref_tbl))   df <- head(ref_tbl[, display_cols], n)   # Shorten V_CDR3_J strings to just V gene for display   for (col in intersect(c(\"TRA_1\", \"TRA_2\", \"TRB_1\", \"TRB_2\"), colnames(df))) {     df[[col]] <- ifelse(is.na(df[[col]]), NA, sub(\"_.*\", \"\", df[[col]]))   }   knitr::kable(df, row.names = FALSE) }"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"stringency-levels","dir":"Articles","previous_headings":"Explore the outputs > Reference tables","what":"Stringency levels","title":"Getting Started with VDJigsaw","text":"stringency levels named along two axes: chains required (alpha beta, just one) many alleles per chain (alleles, just one).","code":""},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"dual_chain_dual_allele","dir":"Articles","previous_headings":"Explore the outputs > Reference tables > Stringency levels","what":"dual_chain_dual_allele","title":"Getting Started with VDJigsaw","text":"strictest level. four chain positions (TRA_1, TRA_2, TRB_1, TRB_2) must match exactly.","code":"cat(nrow(VDJigsaw_ref_tables$dual_chain_dual_allele), \"clonotypes\\n\") ## 7432 clonotypes show_ref(VDJigsaw_ref_tables$dual_chain_dual_allele)"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"dual_chain_one_partial","dir":"Articles","previous_headings":"Explore the outputs > Reference tables > Stringency levels","what":"dual_chain_one_partial","title":"Getting Started with VDJigsaw","text":"chains required, one chain may missing secondary allele (conflict allowed).","code":"cat(nrow(VDJigsaw_ref_tables$dual_chain_one_partial), \"clonotypes\\n\") ## 7139 clonotypes show_ref(VDJigsaw_ref_tables$dual_chain_one_partial)"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"dual_chain_both_partial","dir":"Articles","previous_headings":"Explore the outputs > Reference tables > Stringency levels","what":"dual_chain_both_partial","title":"Getting Started with VDJigsaw","text":"chains required, may missing secondary allele.","code":"cat(nrow(VDJigsaw_ref_tables$dual_chain_both_partial), \"clonotypes\\n\") ## 7117 clonotypes show_ref(VDJigsaw_ref_tables$dual_chain_both_partial)"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"single_chain_dual_allele","dir":"Articles","previous_headings":"Explore the outputs > Reference tables > Stringency levels","what":"single_chain_dual_allele","title":"Getting Started with VDJigsaw","text":"one chain (alpha beta) required, alleles chain must match.","code":"cat(nrow(VDJigsaw_ref_tables$single_chain_dual_allele), \"clonotypes\\n\") ## 7116 clonotypes show_ref(VDJigsaw_ref_tables$single_chain_dual_allele)"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"single_chain_single_allele","dir":"Articles","previous_headings":"Explore the outputs > Reference tables > Stringency levels","what":"single_chain_single_allele","title":"Getting Started with VDJigsaw","text":"permissive level. single allele single chain can define clonotype. Maximizes cell recovery used caution.","code":"cat(nrow(VDJigsaw_ref_tables$single_chain_single_allele), \"clonotypes\\n\") ## 7116 clonotypes show_ref(VDJigsaw_ref_tables$single_chain_single_allele)"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"section","dir":"Articles","previous_headings":"","what":"Getting Started with VDJigsaw","title":"Getting Started with VDJigsaw","text":"Let’s see number clonotypes changes across levels: expected, number unique clonotypes decreases stringency relaxed (cells get merged larger groups).","code":"sapply(VDJigsaw_ref_tables[1:5], nrow) ##     dual_chain_dual_allele     dual_chain_one_partial  ##                       7432                       7139  ##    dual_chain_both_partial   single_chain_dual_allele  ##                       7117                       7116  ## single_chain_single_allele  ##                       7116"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"visualize-results","dir":"Articles","previous_headings":"","what":"Visualize results","title":"Getting Started with VDJigsaw","text":"VDJigsaw includes three built-visualization functions. support per_sample combined arguments multi-sample datasets.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"stringency-summary","dir":"Articles","previous_headings":"Visualize results","what":"Stringency summary","title":"Getting Started with VDJigsaw","text":"two-panel chart shows (top) number unique clonotypes (bottom) number cells assigned stringency level.","code":"plot_stringency_summary(   TCR_data = TCR_data,   per_sample = TRUE,   combined = TRUE)"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"clonotype-composition","dir":"Articles","previous_headings":"Visualize results","what":"Clonotype composition","title":"Getting Started with VDJigsaw","text":"tile chart showing V gene usage top clonotypes given stringency level. Grey tiles indicate missing chains.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"strict-definition","dir":"Articles","previous_headings":"Visualize results > Clonotype composition","what":"Strict definition","title":"Getting Started with VDJigsaw","text":"","code":"plot_list <- plot_clone_composition(   ref_table = VDJigsaw_ref_tables$dual_chain_dual_allele,   top_n = 10,   per_sample = TRUE,   combined = FALSE)  plot_list$Fix +   plot_list$Fresh +   plot_layout(ncol = 1)"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"loose-definition","dir":"Articles","previous_headings":"Visualize results > Clonotype composition","what":"Loose definition","title":"Getting Started with VDJigsaw","text":"","code":"plot_list <- plot_clone_composition(   ref_table = VDJigsaw_ref_tables$single_chain_single_allele,   top_n = 10,   per_sample = TRUE,   combined = FALSE)  plot_list$Fix +   plot_list$Fresh +   plot_layout(ncol = 1)"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"clonotype-flow-alluvial","dir":"Articles","previous_headings":"Visualize results","what":"Clonotype flow (alluvial)","title":"Getting Started with VDJigsaw","text":"alluvial diagram showing clonotypes merge stringency relaxed. vertical axis stringency level, flows show cells moving clone definitions.","code":"plot_list <- plot_clonotype_flow(   TCR_data = TCR_data,   top_n = 10,   per_sample = TRUE,   combined = FALSE)  plot_list$Fix +   plot_list$Fresh +   plot_layout(ncol = 1)"},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"Getting Started with VDJigsaw","text":"Integrate Seurat: Map TCR_data back Seurat object using barcode column annotate cells clone IDs. Cross-reference: Use assign_clonotype_from_reference() map new data existing reference clonotype table. Paired TCR mapping: Use map_clonotypes_to_paired_TCR() match allele-level data paired alpha/beta reference. details, see function documentation: ?assign_clonotype, ?assign_clonotype_from_reference, ?map_clonotypes_to_paired_TCR.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/articles/VDJigsaw_Vignette_01.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Getting Started with VDJigsaw","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.3 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] patchwork_1.3.2 ggplot2_4.0.2   dplyr_1.2.0     VDJigsaw_0.1.0  ##  ## loaded via a namespace (and not attached): ##  [1] sass_0.4.10        generics_0.1.4     tidyr_1.3.2        stringi_1.8.7      ##  [5] digest_0.6.39      magrittr_2.0.4     evaluate_1.0.5     grid_4.5.2         ##  [9] RColorBrewer_1.1-3 iterators_1.0.14   fastmap_1.2.0      foreach_1.5.2      ## [13] doParallel_1.0.17  jsonlite_2.0.0     purrr_1.2.1        scales_1.4.0       ## [17] codetools_0.2-20   textshaping_1.0.4  jquerylib_0.1.4    cli_3.6.5          ## [21] rlang_1.1.7        withr_3.0.2        cachem_1.1.0       yaml_2.3.12        ## [25] tools_4.5.2        parallel_4.5.2     vctrs_0.7.1        R6_2.6.1           ## [29] lifecycle_1.0.5    stringr_1.6.0      fs_1.6.6           ragg_1.5.0         ## [33] pkgconfig_2.0.3    desc_1.4.3         pkgdown_2.2.0      pillar_1.11.1      ## [37] bslib_0.10.0       gtable_0.3.6       glue_1.8.0         systemfonts_1.3.1  ## [41] xfun_0.56          tibble_3.3.1       tidyselect_1.2.1   knitr_1.51         ## [45] farver_2.1.2       htmltools_0.5.9    igraph_2.2.2       rmarkdown_2.30     ## [49] labeling_0.4.3     ggalluvial_0.12.5  compiler_4.5.2     S7_0.2.1"},{"path":"https://doRemy.github.io/VDJigsaw/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Rémy Pétremand. Author, maintainer.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pétremand R (2026). VDJigsaw: Puzzling Together T-Cell Clones Single-Cell TCR-Seq Data. R package version 0.1.0, https://doRemy.github.io/VDJigsaw/.","code":"@Manual{,   title = {VDJigsaw: Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data},   author = {Rémy Pétremand},   year = {2026},   note = {R package version 0.1.0},   url = {https://doRemy.github.io/VDJigsaw/}, }"},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"vdjigsaw--puzzling-together-t-cell-clones-from-single-cell-tcr-seq-data","dir":"","previous_headings":"","what":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"VDJigsaw toolkit processing single-cell TCR-sequencing data clonotype groups varying levels stringency map various types representation.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"Single-cell T Cell Receptor sequencing (scTCR-seq) powerful approach exploring TCR diversity identifying clonally related T cells. TCRs heterodimers composed two protein chains: alpha beta. cases, T cell expected express one alpha-beta pair. However, unlikely cell expresses two distinct beta chains, relatively common (~30%) cell express two alpha chains. Clonotype assignment — grouping cells clone — challenging problem scTCR-seq data. makes particularly non-trivial chain information frequently missing individual cells due sequencing dropout low TCR-chain detection sensitivity. concrete example: imagine two cells, Cell-1 Cell-2, sharing TCR-beta chain. Cell-1 one TCR-alpha chain captured (alpha-1), Cell-2 two (alpha-1 alpha-2). Note alpha-1 matches two cells. Since Cell-1 Cell-2 share beta chain least one alpha chain allele, key question whether: Cell-1 actually second alpha allele identical alpha-1 (homozygous), Cell-1 heterozygous alpha-2 second allele, alpha-2 captured due dropout. Current tools conservatively default first assumption require exact match chains, consider primary alleles chains. However, given immensely large diversity TCRs generated VDJ recombination, reasonable assume Cell-1 Cell-2 belong clonotype — unlikely two independent T-cell clones share beta chain one alpha alleles chance. test , one examine TCR sequences sample evidence refuting hypothesis. conflicting observation exists, reasonable assume cells belong clone missing chain Cell-1 simply failed captured. VDJigsaw addresses “puzzling” different chains together clone IDs varying levels stringency, allowing researchers recover many cells possible coherent clonotype definitions controlling permissive matching . approach reduces number fragmented clonotypes caused missing data offers data-driven method clonotype assignment. See Method section details.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"can install VDJigsaw directly GitHub:","code":"# install.packages(\"devtools\") devtools::install_github(\"doRemy/VDJigsaw\")"},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting Started","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"full walkthrough real data, see Getting Started vignette.","code":"library(VDJigsaw)  # 1. Load VDJ filtered contigs VDJ.contigs <- read.csv(\"filtered_contig_annotations.csv\")  # 2. Assign clonotypes VDJigsaw_res <- assign_clonotype(   VDJ_data = VDJ.contigs,   sample_col = \"orig.ident\",   verbose = TRUE)  # 3. Retrieve outputs TCR_data <- VDJigsaw_res$TCR_data reference_tables <- VDJigsaw_res$ref_tables  # 4. Visualize plot_stringency_summary(TCR_data) plot_clone_composition(reference_tables$dual_chain_dual_allele) plot_clone_composition(reference_tables$single_chain_single_allele)"},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"output","dir":"","previous_headings":"","what":"Output","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"assign_clonotype() returns list two elements: TCR_data — data frame one row per cell barcode, containing TCR alpha/beta chains clone ID column stringency level. ref_tables — named list reference tables (one per stringency level), mapping CloneID TCR chain composition.","code":""},{"path":[]},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"input-format","dir":"","previous_headings":"Method","what":"Input Format","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"pre-processing scTCR-seq data, VDJigsaw processes raw VDJ contigs data table row represents cell (identified barcode) columns :","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"clonotype-stringency-levels","dir":"","previous_headings":"Method","what":"Clonotype Stringency Levels","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"VDJigsaw groups cells clonotypes using hierarchy stringency levels. successive level permissive, incorporating rules levels plus additional, relaxed matching criteria. goal treat missing values potentially compatible rather mismatches, assign many cells possible coherent clonotypes. Note: level stringency, clonotype defined two TCR-alpha two TCR-beta chains. enforced grouping cells clonotype conflicts (.e., two different values chain position within clonotype). stringency levels named along two axes: chains required (α β, just one) many alleles per chain (alleles, just one).","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"dual_chain_dual_allele--both-chains-both-alleles-must-match","dir":"","previous_headings":"Method > Clonotype Stringency Levels","what":"dual_chain_dual_allele — Both chains, both alleles must match","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"strictest level. four chain positions must identical cells. TRA_1, TRA_2, TRB_1, TRB_2 must match.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"dual_chain_one_partial--both-chains-required-one-chain-may-have-a-missing-allele","dir":"","previous_headings":"Method > Clonotype Stringency Levels","what":"dual_chain_one_partial — Both chains required, one chain may have a missing allele","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"Relaxes requirement one two chains: either alpha beta chain can missing secondary allele, long conflicts. Full match four chains, TRA_1, TRB_1, TRB_2 match conflicting TRA_2 values (covers cases TRA_2 missing), TRA_1, TRA_2, TRB_1 match conflicting TRB_2 values (covers cases TRB_2 missing).","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"dual_chain_both_partial--both-chains-required-both-may-have-a-missing-allele","dir":"","previous_headings":"Method > Clonotype Stringency Levels","what":"dual_chain_both_partial — Both chains required, both may have a missing allele","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"Relaxes requirement chains: secondary allele can missing alpha beta chain simultaneously. rules dual_chain_one_partial, TRA_1 TRB_1 match conflicts secondary chains.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"single_chain_dual_allele--only-one-chain-required-but-both-alleles-must-match","dir":"","previous_headings":"Method > Clonotype Stringency Levels","what":"single_chain_dual_allele — Only one chain required, but both alleles must match","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"longer requires receptor chains. clonotype can defined single chain type (alpha beta), long alleles chain match. rules dual_chain_both_partial, TRA_1 TRA_2 match conflicts beta chains, TRB_1 TRB_2 match conflicts alpha chains.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"single_chain_single_allele--the-most-permissive-level","dir":"","previous_headings":"Method > Clonotype Stringency Levels","what":"single_chain_single_allele — The most permissive level","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"clonotype can defined single allele single chain. maximizes cell recovery used caution. rules single_chain_dual_allele, TRA_1 alone matches conflicts chains, TRB_1 alone matches conflicts chains.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"graph-based-clonotype-assignment-algorithm","dir":"","previous_headings":"Method","what":"Graph-Based Clonotype Assignment Algorithm","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"Clonotype assignment performed independently per sample proceeds stringency levels strictest permissive. level, VDJigsaw: Generates clone version strings — cell, relevant chain values (defined current stringency level) concatenated composite identifier. example, strictest level, Sample_TRA1_TRA2_TRB1_TRB2; permissive levels, chain positions omitted. Builds pairwise similarity matrix — cell’s full clone version string compared cells’ clone version strings current level. Two cells considered compatible clone version strings match. Matches stricter levels carried forward, compatibility cumulative. Constructs graph — similarity matrix used adjacency matrix build undirected graph (via igraph), nodes cells edges connect compatible cells. Identifies connected components — connected component graph defines candidate clonotype. Cells edges (match level) remain unassigned. Resolves conflicts — connected component checked conflicts: contains two distinct alleles chain position (e.g., three different TRA_1 values), component invalid. case, VDJigsaw falls back clustering previous (stricter) stringency level affected cells, ensuring clonotype defined two alpha two beta chain alleles. hierarchical approach means cells first assigned strict level retain assignment, successive level adds new assignments cells previously unmatched — always enforcing two-allele-per-chain constraint.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"limitations","dir":"","previous_headings":"","what":"Limitations","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"main limitation approach doublets. two cells captured droplet, TCR chains get mixed, potentially joining unrelated chains single clonotype. recommend running VDJigsaw quality control doublet removal scRNA-seq data.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"use VDJigsaw research, please cite repository: Pétremand, R. VDJigsaw: Puzzling Together T-Cell Clones Single-Cell TCR-Seq Data. https://github.com/doRemy/VDJigsaw","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"project licensed GPL-3.0 License.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"VDJigsaw currently accepting external contributions. may change future — stay tuned.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/index.html","id":"transparency-note","dir":"","previous_headings":"","what":"Transparency Note","title":"Puzzling Together T-Cell Clones from Single-Cell TCR-Seq Data","text":"AI (Claude, Anthropic) used assist documentation writing unit testing. scientific content, methodology, core implementation work author.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/annotate_by_clone.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate clone IDs with reference table metadata — annotate_by_clone","title":"Annotate clone IDs with reference table metadata — annotate_by_clone","text":"Given vector clone IDs (possibly pipe-separated multi-mapped cells), retrieves corresponding annotations reference table. Handles numeric, logical, factor, character columns appropriately.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/annotate_by_clone.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate clone IDs with reference table metadata — annotate_by_clone","text":"","code":"annotate_by_clone(clone_ids, ref_table)"},{"path":"https://doRemy.github.io/VDJigsaw/reference/annotate_by_clone.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate clone IDs with reference table metadata — annotate_by_clone","text":"clone_ids Character vector clone IDs. Pipe-separated IDs indicate cells mapping multiple clonotypes. ref_table reference table clone IDs row names annotation columns.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/annotate_by_clone.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate clone IDs with reference table metadata — annotate_by_clone","text":"data frame columns ref_table, one row per input clone ID.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/assign_clonotype.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign clonotypes from raw VDJ contig data — assign_clonotype","title":"Assign clonotypes from raw VDJ contig data — assign_clonotype","text":"Complete VDJigsaw pipeline takes raw VDJ contig annotations, pivots wide format, validates TCR chains, identifies clonotypes multiple stringency levels, returns annotated data clone assignments.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/assign_clonotype.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign clonotypes from raw VDJ contig data — assign_clonotype","text":"","code":"assign_clonotype(   VDJ_data,   sample_col = NULL,   clone_definition_df = .clone.definition.df,   is_cell = FALSE,   high_confidence = FALSE,   productive = FALSE,   full_length = FALSE,   remove_invalid_VDJ = FALSE,   cdr3_col = \"cdr3_nt\",   num_cores = 1,   clone_loose = \"single_chain_single_allele\",   verbose = TRUE )"},{"path":"https://doRemy.github.io/VDJigsaw/reference/assign_clonotype.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign clonotypes from raw VDJ contig data — assign_clonotype","text":"VDJ_data data frame VDJ contig annotations 10x Genomics format. sample_col Name column VDJ_data use sample identifier. NULL, cells assigned \"Sample\". clone_definition_df Clone definition data frame specifying stringency hierarchy. Defaults built-definition. is_cell Logical. TRUE, filter rows is_cell == \"true\". high_confidence Logical. TRUE, filter rows high_confidence == \"true\". productive Logical. TRUE, filter rows productive == \"true\". full_length Logical. TRUE, filter rows full_length == \"true\". remove_invalid_VDJ Logical. TRUE, set invalid VDJ sequences NA. cdr3_col CDR3 column use building composite TCR chain identifier. Either \"cdr3_nt\" (nucleotide, default) \"cdr3\" (amino acid). num_cores Number cores parallel processing. Set -1 use available cores. Capped number available cores number unique samples. clone_loose stringency level use default \"loose\" clone definition. verbose Logical. TRUE, print progress messages.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/assign_clonotype.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign clonotypes from raw VDJ contig data — assign_clonotype","text":"list two elements: TCR_data Wide-format data frame TCR chains, clone IDs stringency level, default CloneID column. ref_tables Named list reference tables stringency level.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/assign_clonotype.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assign clonotypes from raw VDJ contig data — assign_clonotype","text":"","code":"if (FALSE) { # \\dontrun{ VDJ_contigs <- read.csv(\"filtered_contig_annotations.csv\") result <- assign_clonotype(VDJ_contigs, sample_col = \"origin\") TCR_data <- result$TCR_data ref_tables <- result$ref_tables } # }"},{"path":"https://doRemy.github.io/VDJigsaw/reference/assign_clonotype_from_reference.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign clonotypes by mapping to a reference table — assign_clonotype_from_reference","title":"Assign clonotypes by mapping to a reference table — assign_clonotype_from_reference","text":"Maps TCR data existing reference clonotype table using similarity matrices specified stringency level. Useful mapping new data previously identified clonotypes.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/assign_clonotype_from_reference.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign clonotypes by mapping to a reference table — assign_clonotype_from_reference","text":"","code":"assign_clonotype_from_reference(   TCR_data,   ref_table,   similarity_matrix_type = .mapping.levels,   clone_definition_df = .clone.definition.df )"},{"path":"https://doRemy.github.io/VDJigsaw/reference/assign_clonotype_from_reference.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign clonotypes by mapping to a reference table — assign_clonotype_from_reference","text":"TCR_data data frame columns Sample, TRA_1, TRA_2, TRB_1, TRB_2. ref_table reference table columns Sample, TRA_1, TRA_2, TRB_1, TRB_2, CloneID (output identify_clonotypes). similarity_matrix_type stringency level use matching. One values .mapping.levels. clone_definition_df Clone definition data frame.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/assign_clonotype_from_reference.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign clonotypes by mapping to a reference table — assign_clonotype_from_reference","text":"character vector mapped clone IDs, NA unmapped cells pipe-separated IDs cells matching multiple clonotypes.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/clonotype_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize clonotype changes across stringency levels — clonotype_summary","title":"Summarize clonotype changes across stringency levels — clonotype_summary","text":"Tracks clonotype assignments change stringency level relaxed, identifying clonotypes merged successive level.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/clonotype_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize clonotype changes across stringency levels — clonotype_summary","text":"","code":"clonotype_summary(TCR_data, mapping_levels = .mapping.levels)"},{"path":"https://doRemy.github.io/VDJigsaw/reference/clonotype_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize clonotype changes across stringency levels — clonotype_summary","text":"TCR_data data frame clone ID columns stringency level (output assign_clonotype). mapping_levels Character vector stringency level names order least strict.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/clonotype_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize clonotype changes across stringency levels — clonotype_summary","text":"data frame summarizing number clonotypes whether merging occurred stringency level transition.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/generate_test_VDJ.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate synthetic VDJ contig data for testing — generate_test_VDJ","title":"Generate synthetic VDJ contig data for testing — generate_test_VDJ","text":"Creates small, realistic VDJ contig annotation data frame mimicking 10x Genomics format. Designed unit testing controllable edge cases including dropout, heterozygous chains, invalid VDJ sequences.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/generate_test_VDJ.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate synthetic VDJ contig data for testing — generate_test_VDJ","text":"","code":"generate_test_VDJ(   n_cells = 100,   n_clones = 10,   samples = c(\"SampleA\", \"SampleB\"),   dropout_rate = 0.2,   heterozygous_rate = 0.3,   invalid_rate = 0.05,   seed = 42 )"},{"path":"https://doRemy.github.io/VDJigsaw/reference/generate_test_VDJ.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate synthetic VDJ contig data for testing — generate_test_VDJ","text":"n_cells Number cells generate. Default 50. n_clones Number distinct clonotypes. Default 10. samples Character vector sample names. Default c(\"SampleA\", \"SampleB\"). dropout_rate Proportion cells missing chain data (0-1). Default 0.2. heterozygous_rate Proportion cells heterozygous (dual allele) chains (0-1). Default 0.3. invalid_rate Proportion contigs invalid VDJ (missing V J gene) (0-1). Default 0.05. seed Random seed reproducibility. Default 42.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/generate_test_VDJ.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate synthetic VDJ contig data for testing — generate_test_VDJ","text":"data frame 10x Genomics VDJ contig annotation format columns: barcode, is_cell, contig_id, high_confidence, length, chain, v_gene, d_gene, j_gene, c_gene, full_length, productive, fwr1, fwr1_nt, cdr1, cdr1_nt, fwr2, fwr2_nt, cdr2, cdr2_nt, fwr3, fwr3_nt, cdr3, cdr3_nt, fwr4, fwr4_nt, reads, umis, raw_clonotype_id, raw_consensus_id, exact_subclonotype_id, origin.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/generate_test_VDJ.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate synthetic VDJ contig data for testing — generate_test_VDJ","text":"","code":"test_data <- generate_test_VDJ(n_cells = 20, n_clones = 5, seed = 123) head(test_data) #>      barcode is_cell           contig_id high_confidence length chain v_gene #> 1 CELL0001-1    true CELL0001-1_contig_1            true    514   TRB TRBV21 #> 2 CELL0002-1    true CELL0002-1_contig_2            true    604   TRA  TRAV3 #> 3 CELL0002-1    true CELL0002-1_contig_3            true    417   TRB  TRBV9 #> 4 CELL0003-1    true CELL0003-1_contig_4            true    507   TRA  TRAV3 #> 5 CELL0003-1    true CELL0003-1_contig_5            true    698   TRB  TRBV9 #> 6 CELL0004-1    true CELL0004-1_contig_6            true    564   TRA TRAV14 #>   d_gene j_gene c_gene full_length productive                        fwr1 #> 1  TRBD2  TRBJ1  TRBC2        true       true   CMAWVSDACCIYQPHIDSANVQIFF #> 2   <NA>  TRAJ6   TRAC        true      false   CFPNIGSMNSRANLLEKYFKWDCNF #> 3  TRBD1  TRBJ6  TRBC1       false       true      CVHHNKSDDQCEALGDNANPVF #> 4   <NA>  TRAJ6   TRAC        true       true CNPGLILGWTCWWYPAGFVHTRFFPIF #> 5  TRBD2  TRBJ6  TRBC2        true       true      CDQLYRHSNYKDWPITELTLFF #> 6   <NA> TRAJ14   TRAC        true       true   CGDYQKYEHWIGCVHDDPIKNWCNF #>                                                        fwr1_nt       cdr1 #> 1 CATGAAGGTCACGGGCAGGATATCTAGATTATACACTTCTCTCGACAACAGCTAAGGAAC   CSHEPNPF #> 2 GAGAGAATTAAAGAATAAGTCCGTCGACTCTTTTCAGTGTAGTCGTGGTCTCCTGACAAC  CPVRPQVNF #> 3 CACAGCTCGCGGTAGTAGTGGCGGCCTCGCGGTAACCTTGAAACAAGCTGTAACTAAGTC    CCLCGPF #> 4 GACCTCCCCATGAGCTTCGCGCTGTCAGTTTCTTGCTGACCCCAAGGGCTTCCCCCCCGT    CTSFDGF #> 5 GACACTCCTCAGCGGAGCATATACGTTCTGGCCTGTGAGAATAATCAGCTTGTAGGACCA  CPKTRQTTF #> 6 GATTGTCGGGTCGTCGGCACACTTGCCTCCCTTTTTGGACAAGAGAAAATCTTTCAGGGT CEQITCFDFF #>                    cdr1_nt                  fwr2 #> 1 CTTGACCGAGGAGGGGGTGTGCTA CDNQFQGKAYQWFCAYEMFEF #> 2 TGTCCCAGAGGTCGGTCGATTAAG   CDRDCFFHCSIVWKWQWFF #> 3 CGCGATGTGCACCGCTGGGAATCG CTGFTSKMFQFMPYEEMYGLF #> 4 CAGGGCATCGGAGGCACAACTAGC     CEWKCTNQLHSCLWCIF #> 5 GAACACCCACATCGGACCAGTCAG    CYKKTKLFMSQQPRQHLF #> 6 CAGCTCACGGCTCTGCCGATAAGC     CWHISNLIYVYGHCTNF #>                                              fwr2_nt       cdr2 #> 1 GGAGAAGAAGCAAACCCTTTCTGGTCACGAGGGACTGGCCAAACGGCCCA    CGEDMLF #> 2 ACGCCCGTCGGGACAGAAGTTATCGAAACACAATTTCGTCTTATCGCAGG  CFIRQSAQF #> 3 CGAGCAACTGGATCTGCCCTCCTAAAAACAGAGAAAGTAGGAAGGTTAAC  CLSAGRIAF #> 4 AAGCTCGCCGTTTCCAGGCGGCTTACTGAGTGTAAATATAGAGCGCTTTC  CKREKFQTF #> 5 ACAATCATATCGGGCAATATAAATTCCCGCGCGAATACAACTAAAAGTTA CGELRCHVKF #> 6 ACTCTCGTGATCCTCAGTGGCACTTAATCGGGCTTGCAGAGGGCCTCACA CRKQIQTTHF #>                    cdr2_nt                                      fwr3 #> 1 CAGACCAGTGGCGTAGCCGTTCCC CHHGTYAFLPLCRRIDCGQRWKRSIKSKCKMMEHVMAMGLF #> 2 GGGAACGGAGCCTGCGAAAATTGG     CASIFLKFQWASGYIQQIMYFQAAFDEDQVLNSDNFF #> 3 TATTATAGTGACAGTTTGAGATTT   CETYGHHMAWITQHDARQNTIACFPWYKSATVLKMACMF #> 4 TGACCGAGGTAGGCATTCTCGCGC    CPSCPPGWMNMAIAINISLRLIICQVMCWSCKFGVTNF #> 5 AGCTTCCGGCGTCATAGCGTACAC  CDCDAIDGIRTYWVDSMFNDGELYKRLVMVCFFYWRCLYF #> 6 AAACCACAAGATCGGGCTCTAGTA  CDEKMWKLSNPPREILFVQGWWVGIHNENTLILRLMVYNF #>                                                                                                fwr3_nt #> 1 ATGGTTCCACTGTGACTGACTGTAGGCCGACGTTTGAATTCGTTAGAGGGGTTCCCAACCCGTATTCTCAGGTTTAGATGCAATCGATCAAGCGGGGTGT #> 2 ACAAGTCTAGACGTTTGAAATCCACTTTCGATCCCGAGAGTCATTATCATGTGGTTTAGAGTTCTTGTGGCGAATTAAGGATAATCTCTATTACGTATGC #> 3 AATTGTGTCCCAAATACGTCGCGTGCGGGTTGCATTTCAAAATTCTTGTTAGGCATGTAAGAATTTGGTGCAAGTGTACATGGTCAAGTATTGTTTGCTC #> 4 GTTTCGATGACGGTGCGTCAACGAGGTGCAAAGATATCACCTTTCGGTCTTCGAGCATGTTATCCGCTGGCTAATGTAGAAGACTCGCGGGGTAGTAAGT #> 5 TGATGAGGGAAGTCGAACCCAAACGGCCGCGTGGAACTAGTAGAAGCCGTCACGGTCGCCGGATGCGTGAACGTTAAACCGCAAGTGTGGGACCTGAGGG #> 6 AATTAAGGATGTGACTGGCTGTGTCCAAGGCTTTCTTACAGCGTTCGAGTCCAGTTGCAGATAACCACCAATCCCGTTCCTAACGTCGGTAATTGATACC #>                  cdr3                                                   cdr3_nt #> 1 CTDVCFNPLGLLGSSDEDF GTGTTGCTAGAGTCAAGATGCCCGCTTTGCGGTCAGGGGGGCCAACAAATATTCCCC #> 2        CCEPFWYQDISF                      ATCGTTGATAGCCACCCGAACTGCCCGGGGCTGGTG #> 3  CDSCRDKHKECNKMHPFF    CCTATGGGCAGGGGTGCAGTCAGACGTACTCGCGTTCCAGTGGAGGTGCGCGGA #> 4        CCEPFWYQDISF                      TCTTTACCGGGTGTAACGGCCGTAAAAACCTATTGA #> 5  CDSCRDKHKECNKMHPFF    ACGAGCGCGAAGATGAACACGGGCCTCATCTGGTGACCGACTCCATGAAAAGAT #> 6 CNPVAGRKRSYGMIHSTVF TGCAGCTCTCCCCCGACTATCTGTGCGCTGCAACTTCGGGTCTATTATTCGAAACTG #>             fwr4                        fwr4_nt reads umis raw_clonotype_id #> 1     CMDTYDQFVF CTCCCTTTAAGAAGACCTGGTTACGGACGA   911   40       clonotype3 #> 2  CGHESEKFSMSKF GCGCGAAAAAGCTGCGGGATTCGGTAAAGC  4212   25       clonotype4 #> 3     CPRNKWWGPF AGATGCTAGTTCAACGCTACCACGGCACTA  4272   24       clonotype4 #> 4 CRGRCTDVLNIIKF CCGAGTGGGACACACATTACACTAGTAATA   450   43       clonotype4 #> 5 CMFACEGFWNALEF TGCCTCTTGCCTTCGCGGCTGATTTCGACA  3279    9       clonotype4 #> 6 CVIYYEKMSLEAMF TCTGATTAGGCCAGCAGGGTCCTCAGTGGC   386   15       clonotype3 #>         raw_consensus_id exact_subclonotype_id  origin #> 1 clonotype3_consensus_1                 sub_3 SampleB #> 2 clonotype4_consensus_1                 sub_4 SampleB #> 3 clonotype4_consensus_1                 sub_4 SampleB #> 4 clonotype4_consensus_1                 sub_4 SampleA #> 5 clonotype4_consensus_1                 sub_4 SampleA #> 6 clonotype3_consensus_1                 sub_3 SampleA"},{"path":"https://doRemy.github.io/VDJigsaw/reference/identify_clonotypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify clonotypes at multiple stringency levels — identify_clonotypes","title":"Identify clonotypes at multiple stringency levels — identify_clonotypes","text":"Groups cells clonotypes using hierarchy stringency levels, strict (four chains must match) permissive (single allele suffices). Uses graph-based clustering via igraph find connected components matching cells. Supports parallel processing across samples.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/identify_clonotypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify clonotypes at multiple stringency levels — identify_clonotypes","text":"","code":"identify_clonotypes(   TCR_data,   clone_definition_df = .clone.definition.df,   num_cores = 1,   sample_col = NULL,   clone_loose = \"single_chain_single_allele\",   verbose = TRUE )"},{"path":"https://doRemy.github.io/VDJigsaw/reference/identify_clonotypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify clonotypes at multiple stringency levels — identify_clonotypes","text":"TCR_data data frame columns TRA_1, TRA_2, TRB_1, TRB_2 containing validated TCR chain identifiers. clone_definition_df Clone definition data frame specifying stringency hierarchy. Defaults built-definition. num_cores Number cores parallel processing across samples. Set -1 use available cores. actual number cores used capped number available cores number unique samples. sample_col Name column use sample identifier. NULL, cells treated one sample. clone_loose stringency level use \"loose\" default. One : \"dual_chain_dual_allele\", \"dual_chain_one_partial\", \"dual_chain_both_partial\", \"single_chain_dual_allele\", \"single_chain_single_allele\". verbose Logical. TRUE, print progress messages.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/identify_clonotypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify clonotypes at multiple stringency levels — identify_clonotypes","text":"list two elements: TCR_data Data frame clone ID columns stringency level (CloneID.dual_chain_dual_allele, etc.) plus CloneID.loose. ref_tables Named list reference tables stringency level, containing CloneID, Sample, unique TCR chain info.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/map_clone_id.html","id":null,"dir":"Reference","previous_headings":"","what":"Map clone IDs from VDJigsaw results to wide-format data — map_clone_id","title":"Map clone IDs from VDJigsaw results to wide-format data — map_clone_id","text":"Extracts clone ID columns VDJigsaw results aligns rows wide-format VDJ data frame.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/map_clone_id.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map clone IDs from VDJigsaw results to wide-format data — map_clone_id","text":"","code":"map_clone_id(   VDJigsaw_res,   VDJ_contigs_wide,   cols_to_map = c(\"CloneID.dual_chain_dual_allele\", \"CloneID.loose\",     \"CloneID.dual_chain_one_partial\", \"CloneID.dual_chain_both_partial\",     \"CloneID.single_chain_dual_allele\", \"CloneID.single_chain_single_allele\") )"},{"path":"https://doRemy.github.io/VDJigsaw/reference/map_clone_id.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map clone IDs from VDJigsaw results to wide-format data — map_clone_id","text":"VDJigsaw_res Output identify_clonotypes. VDJ_contigs_wide Wide-format data frame (output pivot_VDJ). cols_to_map Character vector clone ID column names extract.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/map_clone_id.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map clone IDs from VDJigsaw results to wide-format data — map_clone_id","text":"data frame requested clone ID columns, aligned rows VDJ_contigs_wide.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/map_clonotypes_to_paired_TCR.html","id":null,"dir":"Reference","previous_headings":"","what":"Map clonotypes from allele format to paired TCR format — map_clonotypes_to_paired_TCR","title":"Map clonotypes from allele format to paired TCR format — map_clonotypes_to_paired_TCR","text":"Maps TCR data individual allele format (TRA_1/TRA_2/TRB_1/TRB_2) paired alpha/beta chain format (TRA/TRB). Useful reference table uses TRA TRB (second allele) want map allele-level data paired format.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/map_clonotypes_to_paired_TCR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map clonotypes from allele format to paired TCR format — map_clonotypes_to_paired_TCR","text":"","code":"map_clonotypes_to_paired_TCR(   data_to_map,   ref_table,   col_to_map,   map_to_label = NULL )"},{"path":"https://doRemy.github.io/VDJigsaw/reference/map_clonotypes_to_paired_TCR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map clonotypes from allele format to paired TCR format — map_clonotypes_to_paired_TCR","text":"data_to_map data frame columns Sample, TRA_1, TRA_2, TRB_1, TRB_2. ref_table reference table columns Sample, TRA, TRB, column specified col_to_map. col_to_map Name column ref_table map values . map_to_label Optional data frame additional label mapping. Row names correspond mapped values. Factor non-factor columns handled differently.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/map_clonotypes_to_paired_TCR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map clonotypes from allele format to paired TCR format — map_clonotypes_to_paired_TCR","text":"data frame mapping results including strict loose matches, mapping type (strict/loose_A/loose_B/ND), optionally label-mapped columns.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/pivot_VDJ.html","id":null,"dir":"Reference","previous_headings":"","what":"Pivot VDJ contig data to wide format — pivot_VDJ","title":"Pivot VDJ contig data to wide format — pivot_VDJ","text":"Converts VDJ contig annotation data long format (one row per contig) wide format (one row per cell barcode), creating composite TCR chain identifiers (TRA_1, TRA_2, TRB_1, TRB_2) V gene, CDR3, J gene.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/pivot_VDJ.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pivot VDJ contig data to wide format — pivot_VDJ","text":"","code":"pivot_VDJ(   VDJ_data,   sample_col = NULL,   is_cell = FALSE,   high_confidence = FALSE,   productive = FALSE,   full_length = FALSE,   cdr3_col = \"cdr3_nt\",   verbose = TRUE )"},{"path":"https://doRemy.github.io/VDJigsaw/reference/pivot_VDJ.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pivot VDJ contig data to wide format — pivot_VDJ","text":"VDJ_data data frame VDJ contig annotations 10x Genomics format. Must contain columns: barcode, chain, v_gene, cdr3, j_gene, umis, standard 10x VDJ columns. sample_col Name column VDJ_data use sample identifier. NULL, cells assigned single sample called \"Sample\". is_cell Logical. TRUE, filter rows is_cell == \"true\". high_confidence Logical. TRUE, filter rows high_confidence == \"true\". productive Logical. TRUE, filter rows productive == \"true\". full_length Logical. TRUE, filter rows full_length == \"true\". cdr3_col CDR3 column use building composite TCR chain identifier. Either \"cdr3_nt\" (nucleotide sequence, default) \"cdr3\" (amino acid sequence). verbose Logical. TRUE, print progress messages.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/pivot_VDJ.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pivot VDJ contig data to wide format — pivot_VDJ","text":"data frame wide format one row per cell barcode. Contains columns sample, barcode, TCR chain identifiers (TRA_1, TRA_2, TRB_1, TRB_2), contig metadata, individual chain component columns.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_clone_composition.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot clonotype chain composition — plot_clone_composition","title":"Plot clonotype chain composition — plot_clone_composition","text":"Creates tile chart showing V gene usage chain position (TRA_1, TRA_2, TRB_1, TRB_2) across clonotypes given stringency level. tile colored V gene identity, making easy see clones share V gene segments chains present absent.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_clone_composition.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot clonotype chain composition — plot_clone_composition","text":"","code":"plot_clone_composition(   ref_table,   top_n = 20,   sample_filter = NULL,   per_sample = FALSE,   combined = TRUE,   title = \"Clonotype Chain Composition\" )"},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_clone_composition.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot clonotype chain composition — plot_clone_composition","text":"ref_table reference table identify_clonotypes assign_clonotype output (e.g., result$ref_tables$dual_chain_both_partial). Must contain columns: TRA_1, TRB_1. top_n Maximum number clones display. Clones ranked chain richness (number non-NA chains). Remaining clones excluded. sample_filter Optional sample name filter . NULL, samples included. Ignored per_sample = TRUE. per_sample Logical. TRUE, create separate plot unique sample reference table. combined Logical. TRUE per_sample = TRUE, combine per-sample plots single figure using patchwork. FALSE, return named list plots. title Plot title.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_clone_composition.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot clonotype chain composition — plot_clone_composition","text":"ggplot object, named list ggplot objects per_sample = TRUE combined = FALSE.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_clonotype_flow.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot clonotype flow across stringency levels — plot_clonotype_flow","title":"Plot clonotype flow across stringency levels — plot_clonotype_flow","text":"Creates alluvial diagram showing clonotypes merge stringency relaxed. vertical axis represents stringency level, strata represent clonotypes, flows show cells moving clone definitions. Top-N filtering keeps diagram readable.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_clonotype_flow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot clonotype flow across stringency levels — plot_clonotype_flow","text":"","code":"plot_clonotype_flow(   TCR_data,   mapping_levels = .mapping.levels,   top_n = 20,   sample_filter = NULL,   per_sample = FALSE,   combined = TRUE,   show_unassigned = FALSE,   title = \"Clonotype Flow Across Stringency Levels\" )"},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_clonotype_flow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot clonotype flow across stringency levels — plot_clonotype_flow","text":"TCR_data data frame clone ID columns stringency level (output assign_clonotype). mapping_levels Character vector stringency level names order least strict. top_n Maximum number clones show loosest level. upstream clones feeding kept; rest grouped \"\". sample_filter Optional sample name filter . NULL, samples included. Ignored per_sample = TRUE. per_sample Logical. TRUE, create separate plot unique sample. combined Logical. TRUE per_sample = TRUE, combine per-sample plots single figure using patchwork. FALSE, return named list plots. show_unassigned Logical. TRUE, show \"Unassigned\" strata cells NA clone IDs stricter levels. title Plot title.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_clonotype_flow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot clonotype flow across stringency levels — plot_clonotype_flow","text":"ggplot object, named list ggplot objects per_sample = TRUE combined = FALSE.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_clonotype_flow.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot clonotype flow across stringency levels — plot_clonotype_flow","text":"Requires ggalluvial package.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_stringency_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot clonotype assignment summary across stringency levels — plot_stringency_summary","title":"Plot clonotype assignment summary across stringency levels — plot_stringency_summary","text":"Creates two-panel bar chart showing clonotype counts cell assignments change across stringency levels. top panel shows number unique clonotypes level (decreasing clones merge). bottom panel shows number cells assigned vs unassigned level. Counts displayed top bar.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_stringency_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot clonotype assignment summary across stringency levels — plot_stringency_summary","text":"","code":"plot_stringency_summary(   TCR_data,   mapping_levels = .mapping.levels,   sample_filter = NULL,   per_sample = FALSE,   combined = TRUE,   title = \"Clonotype Assignment Summary\" )"},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_stringency_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot clonotype assignment summary across stringency levels — plot_stringency_summary","text":"TCR_data data frame clone ID columns stringency level (output assign_clonotype). mapping_levels Character vector stringency level names order least strict. sample_filter Optional sample name filter . NULL, samples included. Ignored per_sample = TRUE. per_sample Logical. TRUE, create separate plot unique sample. combined Logical. TRUE per_sample = TRUE, combine per-sample plots single figure using patchwork. FALSE, return named list plots. title Plot title.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/plot_stringency_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot clonotype assignment summary across stringency levels — plot_stringency_summary","text":"ggplot object, named list ggplot objects per_sample = TRUE combined = FALSE.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/validate_TCR.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate and correct TCR chain data — validate_TCR","title":"Validate and correct TCR chain data — validate_TCR","text":"Validates TCR chain columns (TRA_1, TRA_2, TRB_1, TRB_2) : Checking V-CDR3-J format validity Reordering chains canonical V_CDR3_J format, Removing duplicate alleles (allele 1 equals allele 2) Swapping alleles allele 2 defined allele 1 missing.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/validate_TCR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate and correct TCR chain data — validate_TCR","text":"","code":"validate_TCR(TCR_data, remove_invalid_VDJ = FALSE, verbose = TRUE)"},{"path":"https://doRemy.github.io/VDJigsaw/reference/validate_TCR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate and correct TCR chain data — validate_TCR","text":"TCR_data data frame columns TRA_1, TRA_2, TRB_1, TRB_2 containing TCR chain identifiers V_CDR3_J format. remove_invalid_VDJ Logical. TRUE, set invalid VDJ sequences (missing V, CDR3, J components) NA. FALSE, keep -flag . verbose Logical. TRUE, print progress messages.","code":""},{"path":"https://doRemy.github.io/VDJigsaw/reference/validate_TCR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate and correct TCR chain data — validate_TCR","text":"input data frame corrected TCR chain columns additional logical columns (TRA_1.invalid, TRA_2.invalid, TRB_1.invalid, TRB_2.invalid) indicating chains invalid VDJ format.","code":""}]
